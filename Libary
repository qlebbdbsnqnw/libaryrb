-- üî• CustomMyLib v4.0 ‚Äî –∫—Ä–∞—Å–∏–≤–∞—è, —Ä–∞–±–æ—á–∞—è, draggable + toggle K + key system —Ñ–∏–∫—Å
-- –ì–æ—Ç–æ–≤ –∫ GitHub: —Å–æ—Ö—Ä–∞–Ω–∏ –∫–∞–∫ CustomMyLib.lua

local CustomMyLib = {}

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

function CustomMyLib:CreateWindow(config)
    config = config or {}
    local window = {}
    window.Title = config.Title or "My Hub"
    window.SubTitle = config.SubTitle or ""
    window.Size = config.Size or UDim2.fromOffset(600, 500)
    window.ToggleKey = config.ToggleKey or Enum.KeyCode.K
    window.Key = config.Key or "123"  -- –ö–ª—é—á –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    window.Tabs = {}
    window.CurrentTab = nil
    window.Visible = false  -- –°–∫—Ä—ã—Ç–æ –¥–æ –≤–≤–æ–¥–∞ –∫–ª—é—á–∞

    -- ScreenGui
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "CustomMyLib_GUI"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = player:WaitForChild("PlayerGui")

    -- Key System (draggable + close + toggle K —Ä–∞–±–æ—Ç–∞–µ—Ç)
    local keyFrame = Instance.new("Frame")
    keyFrame.Size = UDim2.new(0, 350, 0, 200)
    keyFrame.Position = UDim2.new(0.5, -175, 0.5, -100)
    keyFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 40)
    keyFrame.BorderSizePixel = 0
    keyFrame.Parent = screenGui

    local keyCorner = Instance.new("UICorner")
    keyCorner.CornerRadius = UDim.new(0, 16)
    keyCorner.Parent = keyFrame

    local keyStroke = Instance.new("UIStroke")
    keyStroke.Color = Color3.fromRGB(80, 120, 255)
    keyStroke.Thickness = 2
    keyStroke.Parent = keyFrame

    local keyHeader = Instance.new("Frame")
    keyHeader.Size = UDim2.new(1, 0, 0, 50)
    keyHeader.BackgroundColor3 = Color3.fromRGB(35, 35, 55)
    keyHeader.Parent = keyFrame

    local keyHeaderCorner = Instance.new("UICorner")
    keyHeaderCorner.CornerRadius = UDim.new(0, 16)
    keyHeaderCorner.Parent = keyHeader

    local keyTitle = Instance.new("TextLabel")
    keyTitle.Size = UDim2.new(1, -60, 1, 0)
    keyTitle.Position = UDim2.new(0, 20, 0, 0)
    keyTitle.BackgroundTransparency = 1
    keyTitle.Text = "–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á"
    keyTitle.TextColor3 = Color3.fromRGB(100, 200, 255)
    keyTitle.Font = Enum.Font.GothamBold
    keyTitle.TextSize = 24
    keyTitle.TextXAlignment = Enum.TextXAlignment.Left
    keyTitle.Parent = keyHeader

    local keyClose = Instance.new("TextButton")
    keyClose.Size = UDim2.new(0, 40, 0, 40)
    keyClose.Position = UDim2.new(1, -50, 0, 5)
    keyClose.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    keyClose.Text = "‚úï"
    keyClose.TextColor3 = Color3.new(1,1,1)
    keyClose.Font = Enum.Font.GothamBold
    keyClose.TextSize = 24
    keyClose.Parent = keyHeader

    local keyCloseC = Instance.new("UICorner")
    keyCloseC.CornerRadius = UDim.new(0, 10)
    keyCloseC.Parent = keyClose

    keyClose.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)

    local keyBox = Instance.new("TextBox")
    keyBox.Size = UDim2.new(0.8, 0, 0, 50)
    keyBox.Position = UDim2.new(0.1, 0, 0.4, 0)
    keyBox.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
    keyBox.Text = ""
    keyBox.PlaceholderText = "–ö–ª—é—á..."
    keyBox.TextColor3 = Color3.new(1,1,1)
    keyBox.Font = Enum.Font.Gotham
    keyBox.TextSize = 20
    keyBox.Parent = keyFrame

    local keyBoxC = Instance.new("UICorner")
    keyBoxC.CornerRadius = UDim.new(0, 10)
    keyBoxC.Parent = keyBox

    local keyBtn = Instance.new("TextButton")
    keyBtn.Size = UDim2.new(0.8, 0, 0, 50)
    keyBtn.Position = UDim2.new(0.1, 0, 0.7, 0)
    keyBtn.BackgroundColor3 = Color3.fromRGB(80, 150, 255)
    keyBtn.Text = "–í–æ–π—Ç–∏"
    keyBtn.TextColor3 = Color3.new(1,1,1)
    keyBtn.Font = Enum.Font.GothamBold
    keyBtn.TextSize = 22
    keyBtn.Parent = keyFrame

    local keyBtnC = Instance.new("UICorner")
    keyBtnC.CornerRadius = UDim.new(0, 10)
    keyBtnC.Parent = keyBtn

    -- Main Frame (—Å–∫—Ä—ã—Ç–æ –¥–æ –∫–ª—é—á–∞)
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = window.Size
    mainFrame.Position = UDim2.new(0.5, -window.Size.X.Offset/2, 0.5, -window.Size.Y.Offset/2)
    mainFrame.BackgroundColor3 = Color3.fromRGB(22, 22, 35)
    mainFrame.BorderSizePixel = 0
    mainFrame.Visible = false
    mainFrame.Parent = screenGui

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 16)
    mainCorner.Parent = mainFrame

    local mainStroke = Instance.new("UIStroke")
    mainStroke.Color = Color3.fromRGB(80, 120, 255)
    mainStroke.Thickness = 2
    mainStroke.Transparency = 0.4
    mainStroke.Parent = mainFrame

    local mainGradient = Instance.new("UIGradient")
    mainGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(40, 40, 70)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(18, 18, 35))
    }
    mainGradient.Parent = mainFrame

    -- Header main
    local header = Instance.new("Frame")
    header.Size = UDim2.new(1, 0, 0, 70)
    header.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
    header.Parent = mainFrame

    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 16)
    headerCorner.Parent = header

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -100, 0, 40)
    titleLabel.Position = UDim2.new(0, 20, 0, 10)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = window.Title
    titleLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 28
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = header

    local closeMain = Instance.new("TextButton")
    closeMain.Size = UDim2.new(0, 50, 0, 50)
    closeMain.Position = UDim2.new(1, -60, 0, 10)
    closeMain.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeMain.Text = "‚úï"
    closeMain.TextColor3 = Color3.new(1,1,1)
    closeMain.Font = Enum.Font.GothamBold
    closeMain.TextSize = 30
    closeMain.Parent = header

    local closeMainC = Instance.new("UICorner")
    closeMainC.CornerRadius = UDim.new(0, 12)
    closeMainC.Parent = closeMain

    closeMain.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)

    -- Tab Container + Content
    local tabContainer = Instance.new("Frame")
    tabContainer.Size = UDim2.new(0, 160, 1, -70)
    tabContainer.BackgroundColor3 = Color3.fromRGB(25, 25, 45)
    tabContainer.Parent = mainFrame

    local tabList = Instance.new("UIListLayout")
    tabList.Padding = UDim.new(0, 10)
    tabList.Parent = tabContainer

    local content = Instance.new("ScrollingFrame")
    content.Size = UDim2.new(1, -160, 1, -70)
    content.Position = UDim2.new(0, 160, 0, 70)
    content.BackgroundTransparency = 1
    content.ScrollBarThickness = 8
    content.Parent = mainFrame

    local contentList = Instance.new("UIListLayout")
    contentList.Padding = UDim.new(0, 15)
    contentList.Parent = content

    -- Draggable for keyFrame and mainFrame
    local function makeDraggable(frame)
        local dragging = false
        local dragInput, dragStart, startPos
        frame.InputBegan:Connect(function(i)
            if i.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                dragStart = i.Position
                startPos = frame.Position
            end
        end)
        frame.InputChanged:Connect(function(i)
            if i.UserInputType == Enum.UserInputType.MouseMovement then dragInput = i end
        end)
        UserInputService.InputChanged:Connect(function(i)
            if dragInput and dragging then
                local delta = i.Position - dragStart
                frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)
        frame.InputEnded:Connect(function() dragging = false end)
    end

    makeDraggable(keyHeader)
    makeDraggable(header)

    -- Toggle UI on K (–¥–ª—è mainFrame)
    UserInputService.InputBegan:Connect(function(i, gp)
        if gp then return end
        if i.KeyCode == window.ToggleKey then
            window.Visible = not window.Visible
            mainFrame.Visible = window.Visible
        end
    end)

    -- Key check
    keyBtn.MouseButton1Click:Connect(function()
        if keyBox.Text == window.Key then
            keyFrame:Destroy()
            mainFrame.Visible = true
            window.Visible = true
        else
            keyBox.Text = ""
            keyBox.PlaceholderText = "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á!"
        end
    end)

    -- AddTab
    function window:AddTab(tabConfig)
        local tab = {}
        tab.Title = tabConfig.Title or "Tab"
        tab.Elements = {}

        local tabBtn = Instance.new("TextButton")
        tabBtn.Size = UDim2.new(1, -20, 0, 50)
        tabBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 70)
        tabBtn.Text = tab.Title
        tabBtn.TextColor3 = Color3.new(1,1,1)
        tabBtn.Font = Enum.Font.GothamBold
        tabBtn.TextSize = 18
        tabBtn.Parent = tabContainer

        local tbC = Instance.new("UICorner")
        tbC.CornerRadius = UDim.new(0, 10)
        tbC.Parent = tabBtn

        tabBtn.MouseButton1Click:Connect(function()
            for _, t in pairs(window.Tabs) do
                TweenService:Create(t.Btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(40, 40, 70)}):Play()
            end
            TweenService:Create(tabBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 120, 255)}):Play()
            content:ClearAllChildren()
            contentList.Parent = content
            for _, el in pairs(tab.Elements) do
                el.Instance.Parent = content
            end
        end)

        tab.Btn = tabBtn
        table.insert(window.Tabs, tab)

        if #window.Tabs == 1 then tabBtn.MouseButton1Click:Fire() end

        function tab:AddButton(btnConfig)
            local btn = {}
            btn.Title = btnConfig.Title or "Button"
            btn.Callback = btnConfig.Callback or function() end

            local el = Instance.new("TextButton")
            el.Size = UDim2.new(1, -40, 0, 60)
            el.BackgroundColor3 = Color3.fromRGB(55, 55, 90)
            el.Text = btn.Title
            el.TextColor3 = Color3.new(1,1,1)
            el.Font = Enum.Font.GothamBold
            el.TextSize = 20
            el.Visible = false

            local ec = Instance.new("UICorner")
            ec.CornerRadius = UDim.new(0, 12)
            ec.Parent = el

            local eg = Instance.new("UIGradient")
            eg.Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, Color3.fromRGB(80, 80, 140)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(60, 60, 100))
            }
            eg.Parent = el

            el.MouseEnter:Connect(function()
                TweenService:Create(el, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 160)}):Play()
            end)
            el.MouseLeave:Connect(function()
                TweenService:Create(el, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(55, 55, 90)}):Play()
            end)

            el.MouseButton1Click:Connect(btn.Callback)

            btn.Instance = el
            table.insert(tab.Elements, btn)
            return btn
        end

        -- –î–æ–±–∞–≤—å AddToggle, AddSlider –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π)

        return tab
    end

    return window
end

return CustomMyLib
